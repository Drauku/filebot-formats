M:/Videos/Movies/
{any{norm = {it.replaceAll(/[`´‘’ʻ""“”]/, "'").replaceAll(/[:|]/, "-").replaceAll(/[?]/, "!").replaceAll(/[*\s]+/, " ").replaceAll(/\b[IiVvXx]+\b/, { it.upper()}).replaceAll(/\b[0-9](?i:th|nd|rd)\b/,{it.lower()}).replaceTrailingBrackets()};norm(collection).replaceFirst(/^(?i)(The)\s(.+)/, /$2, $1/)+"/[$y] "+{any{csv('C:/FileBot/Settings/Movies/MovieFolderNames.csv').get(n) ?: norm(n)}{norm(n)}}+' '}{csv('C:/FileBot/Settings/Movies/MovieFolderNames.csv').get(n) ?: norm(n).replaceFirst(/^(?i)(The)\s(.+)/, /$2, $1/)+" [$y]"}}{[any{(csv('C:/FileBot/Settings/Movies/MovieGenreFolder.csv').get(n))}{genre.replaceAll('Science Fiction|SciFi & Fantasy','SciFi')}{'No Genre'}]}{"[$rating"+"★]"}{[any{any{certification}{omdb.certification}.replaceAll('N A|NOT RATED','NR').replaceAll(/^ \d+$/, 'PG-$0')}{'NR'}]}{"/"}{csv('C:/FileBot/Settings/Movies/MovieFileNames.csv').get(n) ?: norm(n)}{" "}{[y]}{[fn.matchAll(/extended|uncensored|remastered|unrated|uncut|directors.cut|special.edition/)*.upperInitial()*.lowerTrail().sort().join(', ').replaceAll(/[._]/, " ")]}{"[CD$pi of $pn]"}{" - "}{[any{any{certification}{omdb.certification}.replaceAll('N A|NOT RATED','NR').replaceAll(/^ \d+$/, 'PG-$0')}{'NR'}]}{"[$minutes-min]"}{"[$vf-$vc]"}{"[$af-$ac]"}{"$subt"}{".$ext"}

  
